webpackJsonp([1],{"+E0w":function(t,e){},"/wFW":function(t,e){},"0aMh":function(t,e){},"56iA":function(t,e){},"8c7T":function(t,e){},ECZO:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("7+uW"),i=n("zL8q"),r=n.n(i),a=n("UMRm"),s=n.n(a),c=n("urW8"),u=n.n(c),l=n("Dd8w"),d=n.n(l),p=n("NYxO"),f={name:"login",data:function(){return{loading:!1,loginForm:{login:"",password:""},rules:{login:{required:!0,message:"Введите логин",trigger:"blur"},password:{required:!0,message:"Введите пароль",trigger:"blur"}}}},methods:d()({},Object(p.b)(["login"]),{submitForm:function(t){var e=this,n=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;e.loading=!0,e.login(e.loginForm).then(function(){n.loading=!1},function(){e.loading=!1,e.$message({message:"Неверное имя пользователя или пароль",type:"error"})})})}})},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"600px",margin:"0 auto"}},[n("div",{attrs:{slot:"header"},slot:"header"},[t._v("Авторизация")]),n("el-form",{ref:"loginForm",attrs:{model:t.loginForm,"status-icon":"status-icon",rules:t.rules,"label-width":"120px"}},[n("el-form-item",{attrs:{prop:"login",label:"Логин"}},[n("el-input",{model:{value:t.loginForm.login,callback:function(e){t.$set(t.loginForm,"login",e)},expression:"loginForm.login"}})],1),n("el-form-item",{attrs:{prop:"password",label:"Пароль"}},[n("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("loginForm")}}},[t._v("Вход")])],1)],1)],1)},staticRenderFns:[]};var g=n("VU/8")(f,m,!1,function(t){n("zruw")},null,null).exports,y={name:"Balance",data:function(){return{modalVisibile:!1,activeTab:null,moneySources:[]}},methods:{handleClick:function(t,e){this.moneySources=this.balanceSourcesByType(parseInt(t.name))}},created:function(){this.activeTab=this.moneySourceTypes[0].id.toString(),this.moneySources=this.balanceSourcesByType(this.moneySourceTypes[0].id)},computed:d()({currentMoneySourceType:function(){return parseInt(this.activeTab)}},Object(p.c)(["balance","moneySourceTypes","balanceSourcesByType","moneySourceType"]))},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{staticStyle:{"z-index":"12"},attrs:{title:"Детали по источникам",visible:t.modalVisibile},on:{"update:visible":function(e){t.modalVisibile=e}}},[n("p",{staticStyle:{"line-height":"2"}},[t._v(t._s(t.moneySourceType(t.currentMoneySourceType).title)+":"),n("span",{staticClass:"just-amount"},[t._v(t._s(t.balance(t.currentMoneySourceType)))])]),n("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},t._l(t.moneySourceTypes,function(t){return n("el-tab-pane",{key:t.id,attrs:{label:t.title,name:t.id.toString()}})})),n("el-table",{attrs:{data:t.moneySources,border:"border","show-header":!1}},[n("el-table-column",{attrs:{property:"title",label:"Источник"}}),n("el-table-column",{attrs:{property:"amount",label:"Сумма"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.values,function(e,o){return["грн"===e.currency||"грн"!==e.currency&&0!==e.amount?n("span",{class:e.amount>0?"positive-amount":"negative-amount"},[t._v(t._s(o>0?",":"")+" "+t._s(e.amount.toLocaleString())+" "+t._s(e.currency))]):t._e()]})]}}])})],1)],1),n("div",[t._l(t.moneySourceTypes,function(e){return n("p",{staticStyle:{"line-height":"2"}},[t._v(t._s(e.title)+":"),n("span",{staticClass:"just-amount"},[t._v(t._s(t.balance(e.id)))])])}),n("el-button",{attrs:{round:"round",size:"mini"},on:{click:function(e){t.modalVisibile=!0}}},[t._v("Детально")])],2)],1)},staticRenderFns:[]};var b=n("VU/8")(y,h,!1,function(t){n("pT0i")},null,null).exports,v={name:"App",methods:d()({},Object(p.b)(["whoIAm","logout","getTransactions","getCategories","getMoneySources","getMoneySourceTypes","getBalances"]),{toCategories:function(){this.$router.push("categories")},logoutAndDismiss:function(){this.logoutVisible=!1,this.logout()},changeRoute:function(t){this.$router.push({name:t.name})},fetchData:function(){var t=this;this.whoIAm().then(function(){t.loading=!1,t.logged&&(t.getCategories().then(function(){t.getTransactions(t.period).then(function(){t.loading=!1})}),t.getBalances().then(function(){t.getMoneySources(),t.getMoneySourceTypes().then(function(){t.showBalance=!0})}))},function(){t.loading=!1})}}),computed:d()({},Object(p.c)(["logged","userName"])),data:function(){var t=new Date(Date.now());return{logoutVisible:!1,loading:!0,period:[new Date(Date.now()-27e8),t],showBalance:!1}},created:function(){this.fetchData()},watch:{logged:function(){this.loading=!0,this.fetchData()}},components:{Login:g,Balance:b}},E={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-container",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[n("el-header",[n("h1",{staticClass:"header-title"},[t._v("housekeeper")]),t.logged?n("div",{staticClass:"user-block"},[n("el-popover",{ref:"logout",attrs:{placement:"bottom-start",width:"50"},model:{value:t.logoutVisible,callback:function(e){t.logoutVisible=e},expression:"logoutVisible"}},[n("el-button",{staticStyle:{width:"100%"},attrs:{type:"text"},on:{click:t.logoutAndDismiss}},[t._v("Выйти")])],1),n("el-button",{directives:[{name:"popover",rawName:"v-popover",value:"logout",expression:"'logout'"}]},[t._v("вы вошли как:"),n("b",[t._v(" "+t._s(t.userName))])])],1):t._e()]),n("el-main",[t.logged?n("div",{staticClass:"content"},[n("el-tabs",{attrs:{value:t.$route.name},on:{"tab-click":t.changeRoute}},[n("el-tab-pane",{attrs:{label:"Транзакции",name:"book-keeping"}}),n("el-tab-pane",{attrs:{label:"Отчет",name:"report"}}),n("el-tab-pane",{attrs:{label:"Настройки",name:"settings"}})],1),n("el-card",[n("el-row",[n("el-col",{attrs:{sm:10}},[n("span",[t._v("Период:")]),t._v("   "),n("el-date-picker",{attrs:{format:"dd.MM.yyyy",type:"daterange"},on:{input:t.getTransactions},model:{value:t.period,callback:function(e){t.period=e},expression:"period"}})],1),n("el-col",{attrs:{sm:10,offset:4}},[t.showBalance?n("Balance"):n("span",[t._v("загрузка баланса...")])],1)],1)],1),n("router-view",{staticClass:"margin-top-10"})],1):n("Login")],1)],1)},staticRenderFns:[]};var S=n("VU/8")(v,E,!1,function(t){n("XbFk")},null,null).exports,T=n("/ocq"),_=n("woOf"),k=n.n(_),O=n("//Fk"),w=n.n(O),M={data:function(){return{entityForEdit:null,editModal:!1,rules:[]}},methods:{deleteEntity:function(t){return new w.a},sendEntity:function(t){},createNewEntity:function(){return{}},edit:function(t){var e={};t?k()(e,t):e=this.createNewEntity(),this.entityForEdit=e,this.editModal=!0},cancelEdit:function(){this.entityForEdit=null,this.editModal=!1},save:function(){var t=this;this.$refs.editForm.validate(function(e){if(!e)return t.$message({message:"Введите корректно все необходимые данные",type:"error"}),!1;t.sendEntity(t.entityForEdit),t.cancelEdit()})},remove:function(t){var e=this;this.$confirm("Удаление необратимо, Вы уверены что хотите удалить строку?","Внимание",{confirmButtonText:"Да",cancelButtonText:"Отмена",type:"warning"}).then(function(){e.deleteEntity(t).then(function(){e.$message({type:"success",message:"Строка удалена"})},function(){e.$message({type:"error",message:"Ошибка удаления"})})})}}},x=(n("4Cmz"),n("8dOo")),C=n.n(x),F={name:"numericInput",mixins:[i.Input],props:{positive:{type:Boolean,default:!0}},data:function(){return{muttableValue:this.value}},mounted:function(){var t=this;C()({groupSeparator:" ",autoGroup:!0,alias:"numeric",rightAlign:!1,removeMaskOnSubmit:!0,allowMinus:!0,allowPlus:!1,autounmask:!0,decimalProtect:!1,radixPoint:".",enforceDigitsOnBlur:!0}).mask(this.$refs.input);this.$refs.input.addEventListener("input",function(){t.mutableValue=parseFloat(this.inputmask.unmaskedvalue()),isNaN(t.mutableValue)&&(t.mutableValue=null),t.$emit("input",t.mutableValue)})}};var R=n("VU/8")(F,null,!1,function(t){n("/wFW")},null,null).exports,A={name:"fixedDrop",props:{options:{type:Object}},data:function(){return{visible:!1}},created:function(){var t=this;"onscroll"===this.options.trigger&&(window.onscroll=function(){var e=window.pageYOffset>=t.options.offsetY;t.visible!==e&&(t.$emit("visible",e),t.visible=e)})}},I={render:function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"slide-fade"}},[this.visible?e("el-card",{staticClass:"fixed-action-block"},[this._t("default")],2):this._e()],1)},staticRenderFns:[]};var N={name:"book-keeping",mixins:[M],data:function(){return{rules:{categoryId:[{type:"number",required:!0,message:"Обязательно к заполнению",trigger:"blur"}],amount:[{type:"number",required:!0,message:"Обязательно к заполнению",trigger:"blur"}],date:[{type:"string",required:!0,message:"Обязательно к заполнению",trigger:"blur"}]}}},components:{NumericInput:R,FixedDrop:n("VU/8")(A,I,!1,function(t){n("zSlc")},null,null).exports,Balance:b},computed:d()({},Object(p.c)(["transactions","categories","categoriesByType","tags","category","moneySources"])),methods:d()({},Object(p.b)(["createTransaction","updateTransaction","deleteTransaction"]),{createNewEntity:function(){return{categoryId:null,date:"",amount:null,note:null,moneySourceId:null,currency:"грн"}},deleteEntity:function(t){return this.deleteTransaction(t)},sendEntity:function(t){var e=this.category(t.categoryId);1===e.type&&t.amount>0&&(t.amount=-t.amount),2===e.type&&t.amount<0&&(t.amount=-t.amount),console.log(t.amount),t.id?this.updateTransaction(t):this.createTransaction(t)},getAmountCaption:function(t){return t.amount.toLocaleString()+" "+t.currency},getAmountClass:function(t){return t.amount<=0?"negative-amount":"positive-amount"}})},U={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"book-keeping"},[n("el-dialog",{attrs:{visible:t.editModal,title:"Транзакция"},on:{"update:visible":function(e){t.editModal=e}}},[t.editModal?n("el-form",{ref:"editForm",attrs:{model:t.entityForEdit,rules:t.rules,"label-width":"120px","label-position":"right"}},[n("el-form-item",{attrs:{label:"Категория",required:"required"}},[n("el-col",{attrs:{span:7}},[n("el-form-item",{attrs:{prop:"categoryId"}},[n("el-select",{attrs:{filterable:"filterable",placeholder:"Выбрать категорию"},model:{value:t.entityForEdit.categoryId,callback:function(e){t.$set(t.entityForEdit,"categoryId",e)},expression:"entityForEdit.categoryId"}},t._l(t.categoriesByType,function(e){return n("el-option-group",{key:e.title,attrs:{label:e.title}},t._l(e.categories,function(t){return n("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}))}))],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"Дата",prop:"date"}},[n("el-date-picker",{attrs:{placeholder:"Выбрать дату",format:"dd.MM.yyyy","value-format":"dd.MM.yyyy"},model:{value:t.entityForEdit.date,callback:function(e){t.$set(t.entityForEdit,"date",e)},expression:"entityForEdit.date"}})],1)],1)],1),n("el-form-item",{attrs:{label:"Сумма",required:"required"}},[n("el-col",{attrs:{span:7}},[n("el-form-item",{attrs:{prop:"amount"}},[n("numeric-input",{attrs:{placeholder:"Ввести сумму"},model:{value:t.entityForEdit.amount,callback:function(e){t.$set(t.entityForEdit,"amount",e)},expression:"entityForEdit.amount"}})],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"Валюта",prop:"currency",required:"required"}},[n("el-radio-group",{attrs:{size:"medium"},model:{value:t.entityForEdit.currency,callback:function(e){t.$set(t.entityForEdit,"currency",e)},expression:"entityForEdit.currency"}},[n("el-radio-button",{attrs:{label:"грн"}}),n("el-radio-button",{attrs:{label:"$"}}),n("el-radio-button",{attrs:{label:"€"}})],1)],1)],1)],1),n("el-form-item",{attrs:{label:"Источник",required:"required"}},[n("el-col",{attrs:{span:7}},[n("el-form-item",[n("el-select",{model:{value:t.entityForEdit.moneySourceId,callback:function(e){t.$set(t.entityForEdit,"moneySourceId",e)},expression:"entityForEdit.moneySourceId"}},t._l(t.moneySources,function(t,e){return n("el-option",{key:e,attrs:{value:t.id,label:t.title}})}))],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"Заметки",prop:"note"}},[n("el-input",{staticClass:"book-keeping-input",attrs:{placeholder:"Ввести заметку",maxlength:50},model:{value:t.entityForEdit.note,callback:function(e){t.$set(t.entityForEdit,"note",e)},expression:"entityForEdit.note"}})],1)],1)],1),n("el-button-group",{staticStyle:{float:"right"}},[n("el-button",{attrs:{round:"round"},on:{click:t.cancelEdit}},[t._v("Отменить")]),n("el-button",{attrs:{type:"success",round:"round"},on:{click:t.save}},[t._v("Сохранить")])],1),n("div",{staticStyle:{clear:"both"}})],1):t._e()],1),n("FixedDrop",{attrs:{options:{trigger:"onscroll",offsetY:100}}},[n("el-row",[n("el-col",{attrs:{md:24,xs:24}},[n("Balance",{staticStyle:{display:"inline-block"}}),n("el-button",{staticStyle:{margin:"10px 30px",float:"right"},attrs:{type:"success",icon:"el-icon-plus",round:"round"},on:{click:function(e){t.edit()}}},[t._v("Добавить транзакцию")])],1)],1)],1),n("el-card",[n("el-row",[n("el-col",{attrs:{sm:12}},[t._v(" ")]),n("el-col",{attrs:{sm:12}},[n("el-button",{staticStyle:{float:"right"},attrs:{type:"success",icon:"el-icon-plus",round:"round"},on:{click:function(e){t.edit()}}},[t._v("Добавить транзакцию")])],1)],1),n("el-table",{attrs:{data:t.transactions}},[n("el-table-column",{attrs:{label:"Категория"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t.category(e.row.categoryId).title))])]}}])}),n("el-table-column",{attrs:{prop:"date",label:"Дата"}}),n("el-table-column",{attrs:{label:"Сумма"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{class:t.getAmountClass(e.row)},[t._v(t._s(t.getAmountCaption(e.row)))])]}}])}),n("el-table-column",{attrs:{label:"Заметки",prop:"note"}}),n("el-table-column",{attrs:{label:"Действия"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button-group",[n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit",round:"round"},on:{click:function(n){t.edit(e.row)}}}),n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",round:"round"},on:{click:function(n){t.remove(e.row)}}})],1)]}}])})],1)],1)],1)},staticRenderFns:[]};var D=n("VU/8")(N,U,!1,function(t){n("8c7T")},null,null).exports,$={created:function(){this.getCategories(),this.getMoneySources(),this.getMoneySourceTypes()},computed:d()({},Object(p.c)(["categories","categoriesByType","moneySources","moneySourceTypes"])),methods:d()({},Object(p.b)(["getCategories","getMoneySources","getMoneySourceTypes"]))},B={name:"categories",mixins:[$,M],data:function(){return{entityForEdit:null,editModal:!1,rules:{type:[{type:"number",required:!0,message:"Обязательно к заполнению",trigger:"blur"}],title:[{type:"string",required:!0,message:"Обязательно к заполнению",trigger:"blur"}]}}},methods:d()({},Object(p.b)(["createCategory","updateCategory","deleteCategory"]),{deleteEntity:function(t){return this.deleteCategory(t)},sendEntity:function(t){t.id?this.updateCategory(t):this.createCategory(t)},createNewEntity:function(){return{title:"",icon:null,type:1,transit:0}}})},q={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{visible:t.editModal,width:"60%",title:"Категория"},on:{"update:visible":function(e){t.editModal=e}}},[t.editModal?n("el-form",{ref:"editForm",attrs:{inline:!0,model:t.entityForEdit,rules:t.rules,"label-position":"top"}},[n("el-form-item",{attrs:{label:"Тип",prop:"type"}},[n("el-select",{model:{value:t.entityForEdit.type,callback:function(e){t.$set(t.entityForEdit,"type",e)},expression:"entityForEdit.type"}},[n("el-option",{attrs:{label:"Расходы",value:1}}),n("el-option",{attrs:{label:"Доходы",value:2}})],1)],1),n("el-form-item",{attrs:{label:"Название",prop:"title"}},[n("el-input",{attrs:{placeholder:"Введите название"},model:{value:t.entityForEdit.title,callback:function(e){t.$set(t.entityForEdit,"title",e)},expression:"entityForEdit.title"}})],1),n("el-form-item",{attrs:{prop:"transit"}},[n("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.entityForEdit.transit,callback:function(e){t.$set(t.entityForEdit,"transit",e)},expression:"entityForEdit.transit"}},[t._v("Не учитывать в отчетах")])],1),n("el-form-item",{attrs:{label:"Действия"}},[n("el-button-group",[n("el-button",{attrs:{type:"success",round:"round"},on:{click:t.save}},[t._v("Сохранить")]),n("el-button",{attrs:{round:"round"},on:{click:t.cancelEdit}},[t._v("Отменить")])],1)],1)],1):t._e()],1),n("el-button",{staticStyle:{float:"right"},attrs:{type:"success",icon:"el-icon-plus",round:"round"},on:{click:function(e){t.edit()}}},[t._v("Добавить категорию")]),t._l(t.categoriesByType,function(e,o){return n("div",{key:o,staticStyle:{"margin-top":"20px"}},[n("h4",[t._v(t._s(e.title))]),n("el-table",{attrs:{data:e.categories}},[n("el-table-column",{attrs:{label:"Название",prop:"title"}}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button-group",[n("el-button",{attrs:{size:"mini",round:"round"},on:{click:function(n){t.edit(e.row)}}},[t._v("Корректировать")]),n("el-button",{attrs:{type:"danger",size:"mini",round:"round"},on:{click:function(n){t.remove(e.row)}}},[t._v("Удалить")])],1)]}}])})],1)],1)})],2)},staticRenderFns:[]};var Y=n("VU/8")(B,q,!1,function(t){n("56iA")},null,null).exports,P={name:"report",data:function(){return{yearMonth:new Date(Date.now()),transactionType:1,loading:!1}},computed:d()({},Object(p.c)(["incomes","expenses","categoriesByType","category","totalExpense","totalIncome","totalIncomeBySources","totalExpenseBySources","moneySource"]),{transactions:function(){return 1===this.transactionType?this.expenses:this.incomes},totalBySources:function(){return 1===this.transactionType?this.totalExpenseBySources:this.totalIncomeBySources},total:function(){return 1===this.transactionType?this.totalExpense:this.totalIncome},chartData:function(){var t=this,e=this.categoriesByType[1===this.transactionType?0:1].categories.map(function(t){return t.title}),n={};this.transactions.forEach(function(e){var o=t.category(e.categoryId);o.type!==t.transactionType||o.transit||"$"!==e.currency&&(n[o.title]||(n[o.title]=0),n[o.title]+=e.amount)});var o=[];for(var i in n)o.push({name:i,value:n[i]});return{title:{text:"Отчет",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} грн ({d}%)"},legend:{orient:"vertical",data:e},series:[{name:"Расходы",type:"pie",radius:["50%","70%"],data:o}]}}})},z={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[n("el-row",[n("el-col",{attrs:{sm:12}},[n("el-select",{model:{value:t.transactionType,callback:function(e){t.transactionType=e},expression:"transactionType"}},[n("el-option",{attrs:{label:"Расходы",value:1}}),n("el-option",{attrs:{label:"Доходы",value:2}})],1)],1)],1),0===t.chartData.series[0].data.length?n("el-alert",{staticStyle:{"margin-top":"20px"},attrs:{type:"info",title:"Данные для отчета отсутствуют","show-icon":"show-icon",closable:!1}}):t._e(),t.transactions.length>0?n("div",[n("el-row",[n("el-col",{attrs:{sm:15}},[n("chart",{attrs:{options:t.chartData}})],1),n("el-col",{attrs:{sm:9}},[n("h2",[t._v(t._s(t.total.toLocaleString())+" грн")]),n("br"),t._l(t.totalBySources,function(e){return[n("h3",{staticClass:"source-report"},[t._v(t._s(e.title)+" : "+t._s(e.amount)+" грн")]),n("hr")]})],2)],1)],1):t._e()],1)],1)},staticRenderFns:[]};var L=n("VU/8")(P,z,!1,function(t){n("lRnY")},null,null).exports,G={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("el-tabs",{attrs:{type:"border-card",value:this.$route.name},on:{"tab-click":this.changeRoute}},[e("el-tab-pane",{attrs:{label:"Настройки категорий",name:"categories"}},[e("router-view")],1),e("el-tab-pane",{attrs:{label:"Источники денег",name:"moneySources"}},[e("router-view")],1),e("el-tab-pane",{attrs:{label:"Типы источников",name:"moneySourceTypes"}},[e("router-view")],1)],1)],1)},staticRenderFns:[]};var V=n("VU/8")({name:"settings",methods:{changeRoute:function(t){this.$router.push({name:t.name})}}},G,!1,function(t){n("0aMh")},null,null).exports,j={name:"moneySources",mixins:[$,M],data:function(){return{entityForEdit:null,editModal:!1,rules:{title:[{type:"string",required:!0,message:"Обязательно к заполнению",trigger:"blur"}]}}},methods:d()({},Object(p.b)(["createMoneySource","updateMoneySource","deleteMoneySource"]),{deleteEntity:function(t){return this.deleteMoneySource(t)},sendEntity:function(t){t.id?this.updateMoneySource(t):this.createMoneySource(t)},createNewEntity:function(){return{title:""}}})},H={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{visible:t.editModal,width:"60%",title:"Источник"},on:{"update:visible":function(e){t.editModal=e}}},[t.editModal?n("el-form",{ref:"editForm",attrs:{inline:!0,model:t.entityForEdit,rules:t.rules,"label-position":"top"}},[n("el-form-item",{attrs:{prop:"typeId",label:"Тип"}},[n("el-select",{attrs:{placeholder:"Выбрать тип"},model:{value:t.entityForEdit.typeId,callback:function(e){t.$set(t.entityForEdit,"typeId",e)},expression:"entityForEdit.typeId"}},t._l(t.moneySourceTypes,function(t){return n("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}))],1),n("el-form-item",{attrs:{label:"Название",prop:"title"}},[n("el-input",{attrs:{placeholder:"Введите название"},model:{value:t.entityForEdit.title,callback:function(e){t.$set(t.entityForEdit,"title",e)},expression:"entityForEdit.title"}})],1),n("el-form-item",{attrs:{label:"Действия"}},[n("el-button-group",[n("el-button",{attrs:{type:"success",round:"round"},on:{click:t.save}},[t._v("Сохранить")]),n("el-button",{attrs:{round:"round"},on:{click:t.cancelEdit}},[t._v("Отменить")])],1)],1)],1):t._e()],1),n("el-button",{staticStyle:{float:"right"},attrs:{type:"success",icon:"el-icon-plus",round:"round"},on:{click:function(e){t.edit()}}},[t._v("Добавить источник")]),n("div",{staticStyle:{"margin-top":"20px"}},[n("el-table",{attrs:{data:t.moneySources}},[n("el-table-column",{attrs:{label:"Название",prop:"title"}}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button-group",[n("el-button",{attrs:{size:"mini",round:"round"},on:{click:function(n){t.edit(e.row)}}},[t._v("Корректировать")]),n("el-button",{attrs:{type:"danger",size:"mini",round:"round"},on:{click:function(n){t.remove(e.row)}}},[t._v("Удалить")])],1)]}}])})],1)],1)],1)},staticRenderFns:[]};var W=n("VU/8")(j,H,!1,function(t){n("fx/J")},null,null).exports,K={name:"moneySourceTypes",mixins:[$,M],data:function(){return{entityForEdit:null,editModal:!1,rules:{title:[{type:"string",required:!0,message:"Обязательно к заполнению",trigger:"blur"}]}}},methods:d()({},Object(p.b)(["createMoneySourceType","updateMoneySourceType","deleteMoneySourceType"]),{deleteEntity:function(t){return this.deleteMoneySourceType(t)},sendEntity:function(t){t.id?this.updateMoneySourceType(t):this.createMoneySourceType(t)},createNewEntity:function(){return{title:""}}})},J={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{visible:t.editModal,width:"60%",title:"Тип источника"},on:{"update:visible":function(e){t.editModal=e}}},[t.editModal?n("el-form",{ref:"editForm",attrs:{inline:!0,model:t.entityForEdit,rules:t.rules,"label-position":"top"}},[n("el-form-item",{attrs:{label:"Название",prop:"title"}},[n("el-input",{attrs:{placeholder:"Введите название"},model:{value:t.entityForEdit.title,callback:function(e){t.$set(t.entityForEdit,"title",e)},expression:"entityForEdit.title"}})],1),n("el-form-item",{attrs:{label:"Действия"}},[n("el-button-group",[n("el-button",{attrs:{type:"success",round:"round"},on:{click:t.save}},[t._v("Сохранить")]),n("el-button",{attrs:{round:"round"},on:{click:t.cancelEdit}},[t._v("Отменить")])],1)],1)],1):t._e()],1),n("el-button",{staticStyle:{float:"right"},attrs:{type:"success",icon:"el-icon-plus",round:"round"},on:{click:function(e){t.edit()}}},[t._v("Добавить тип источника")]),n("div",{staticStyle:{"margin-top":"20px"}},[n("el-table",{attrs:{data:t.moneySourceTypes}},[n("el-table-column",{attrs:{label:"Название",prop:"title"}}),n("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button-group",[n("el-button",{attrs:{size:"mini",round:"round"},on:{click:function(n){t.edit(e.row)}}},[t._v("Корректировать")]),n("el-button",{attrs:{type:"danger",size:"mini",round:"round"},on:{click:function(n){t.remove(e.row)}}},[t._v("Удалить")])],1)]}}])})],1)],1)],1)},staticRenderFns:[]};var Q=n("VU/8")(K,J,!1,function(t){n("bNax")},null,null).exports;o.default.use(T.a);var X,Z,tt=new T.a({routes:[{path:"/",name:"book-keeping",component:D},{path:"/report",name:"report",component:L},{path:"/settings",name:"settings",component:V,redirect:{name:"categories"},children:[{path:"/settings/categories",name:"categories",component:Y},{path:"/settings/money-sources",name:"moneySources",component:W},{path:"/settings/money-source-types",name:"moneySourceTypes",component:Q}]}]}),et=(n("+E0w"),n("bOdI")),nt=n.n(et),ot=n("gRE1"),it=n.n(ot),rt=n("mtWM"),at=n.n(rt),st={get:function(t,e){var n=e.request,o=e.token;return this.request("get",t,{request:n,token:o})},post:function(t,e){var n=e.request,o=e.token;return this.request("post",t,{request:n,token:o})},patch:function(t,e){var n=e.request,o=e.token;return this.request("patch",t,{request:n,token:o})},delete:function(t,e){var n=e.request,o=e.token;return this.request("delete",t,{request:n,token:o})},request:function(t,e,n){var o=n.request,i=function(t,e){var n={baseURL:"http://f3mann-001-site1.dtempurl.com/api"};return t&&(n.headers={Authorization:"Bearer "+t}),at.a.create(n)}(n.token);return new w.a(function(n,r){i[t](e,o).then(function(t){return n(t)}).catch(function(t){return r(t)})})}},ct=n("mvHQ"),ut=n.n(ct),lt=function(t){var e=ut()(t);return e=(e=e.replace(/(\w)(\w*)/g,function(t,e,n){return console.log(t),console.log(e),console.log(n),e.toUpperCase()+n})).replace(/(:Null)/g,":null"),console.log(e),t=JSON.parse(e)},dt="/bookkeeping/categories/",pt="/bookkeeping/moneysources/",ft={state:{transactions:[],wallets:[],tags:[],categories:[],moneySources:[],moneySourceTypes:[],balances:[],currentPeriod:null,currencies:["грн","$","€"]},getters:{transactions:function(t){return t.transactions},currencies:function(t){return t.currencies},categories:function(t){return t.categories},moneySources:function(t){return t.moneySources},moneySourceTypes:function(t){return t.moneySourceTypes},incomes:function(t){return t.transactions.filter(function(t){return t.amount>0})},expenses:function(t){return t.transactions.filter(function(t){return t.amount<0})},totalTransactionOf:function(t,e){return function(t){var n=0;return e[t].forEach(function(t){console.log(e.category(t.categoryId)),e.category(t.categoryId).transit||(n+=t.amount)}),n}},totalIncome:function(t,e){return e.totalTransactionOf("incomes")},totalExpense:function(t,e){return e.totalTransactionOf("expenses")},totalBySourceOf:function(t,e){return function(t){var n=[];return e[t].forEach(function(t){if(!e.category(t.categoryId).transit){var o=t.moneySourceId||0,i=n.find(function(t){return t.id===o});i||(i={id:o,title:o?e.moneySource(o).title:"Не определено",amount:0},n.push(i)),i.amount+=t.amount}}),n}},totalIncomeBySources:function(t,e){return e.totalBySourceOf("incomes")},totalExpenseBySources:function(t,e){return e.totalBySourceOf("expenses")},balance:function(t,e){return function(t){var n={};e.balanceSourcesByType(t).forEach(function(t){t.values.forEach(function(t){n[t.currency]||(n[t.currency]=0),n[t.currency]+=t.amount})});var o=[];for(var i in n){var r=n[i];o.push(r.toFixed(2)+" "+i)}return 0===o.length?"0 грн":o.join(", ")}},balanceBySources:function(t,e){return t.balances},balanceSourcesByType:function(t){return function(e){return t.balances.filter(function(t){return t.sourceTypeId===e})}},categoriesByType:function(t,e){return[{title:"Расходы",categories:e.getCategoryByType(1)},{title:"Доходы",categories:e.getCategoryByType(2)}]},getCategoryByType:function(t,e){return function(t){return e.categories.filter(function(e){return e.type===t})}},tags:function(t){return t.tags},category:function(t){return function(e){return t.categories.find(function(t){return t.id===e})}},moneySource:function(t){return function(e){return t.moneySources.find(function(t){return t.id===e})}},moneySourceType:function(t){return function(e){return t.moneySourceTypes.find(function(t){return t.id===e})}}},actions:{get:function(t,e){var n=t.commit,o=(t.state,t.rootGetters),i=e.url,r=e.mutation;return new w.a(function(t,e){st.get(i,{token:o.token}).then(function(e){t(),n(r,{value:e.data})})})},create:function(t,e){var n=t.commit,o=(t.state,t.rootGetters),i=t.dispatch,r=e.url,a=e.mutation,s=e.entity,c=e.afterDispatch;st.post(r,{token:o.token,request:lt(s)}).then(function(t){n(a,{value:t.data}),i(c)})},update:function(t,e){var n=t.commit,o=(t.state,t.rootGetters),i=e.url,r=e.mutation,a=e.entity;st.patch(i,{request:a,token:o.token}).then(function(t){n(r,{value:t.data})})},delete:function(t,e){var n=t.commit,o=(t.state,t.rootGetters),i=e.url,r=e.mutation,a=e.entity;return new w.a(function(t,e){st.delete(i,{token:o.token}).then(function(o){o.data?(t(),n(r,{value:a})):e(o.data)},function(t){return e(t)})})},getTransactions:function(t,e){var n=t.commit,o=t.rootGetters,i={};if(e&&2===e.length){var r=e[0];console.log(e);var a=r?"string"==typeof r?r:new Date(r.getFullYear(),r.getMonth(),r.getDate()).toDateString():"",s=e[1],c=s?"string"==typeof s?s:new Date(s.getFullYear(),s.getMonth(),s.getDate()).toDateString():"";i={dateFrom:a,dateTo:c}}return n("SET_CURRENT_PERIOD",{period:it()(i)}),new w.a(function(t,e){st.get("/bookkeeping/transactions",{token:o.token,request:{params:d()({},i)}}).then(function(e){t(),n("SET_TRANSACTIONS",{transactions:e.data})})})},createTransaction:function(t,e){var n=t.commit,o=t.state,i=t.rootGetters,r=t.dispatch;st.post("/bookkeeping/transactions/",{request:lt(e),token:i.token}).then(function(t){n("CREATE_TRANSACTION",{transaction:t.data}),r("getTransactions",o.currentPeriod),r("getBalances",o.currentPeriod)})},updateTransaction:function(t,e){var n=t.commit,o=t.state,i=t.rootGetters,r=t.dispatch;st.patch("/bookkeeping/transactions/"+e.id,{request:e,token:i.token}).then(function(t){n("UPDATE_TRANSACTION",{transaction:e}),r("getBalances",o.currentPeriod)})},deleteTransaction:function(t,e){var n=t.commit,o=t.state,i=t.rootGetters,r=t.dispatch;st.delete("/bookkeeping/transactions/"+e.id,{token:i.token}).then(function(t){n("DELETE_TRANSACTION",{transaction:e}),r("getBalances",o.currentPeriod)})},getCategories:function(t){return(0,t.dispatch)("get",{url:dt,mutation:"SET_CATEGORIES"})},createCategory:function(t,e){(0,t.dispatch)("create",{url:dt,mutation:"CREATE_CATEGORY",entity:e,afterDispatch:"getCategories"})},updateCategory:function(t,e){(0,t.dispatch)("update",{url:dt+e.id,mutation:"UPDATE_CATEGORY",entity:e})},deleteCategory:function(t,e){return(0,t.dispatch)("delete",{url:dt+e.id,mutation:"DELETE_CATEGORY",entity:e})},getMoneySources:function(t){return(0,t.dispatch)("get",{url:pt,mutation:"SET_MONEYSOURCES"})},createMoneySource:function(t,e){(0,t.dispatch)("create",{url:pt,mutation:"CREATE_MONEYSOURCE",entity:e,afterDispatch:"getMoneySources"})},updateMoneySource:function(t,e){(0,t.dispatch)("update",{url:pt+e.id,mutation:"UPDATE_MONEYSOURCE",entity:e})},deleteMoneySource:function(t,e){return(0,t.dispatch)("delete",{url:pt+e.id,mutation:"DELETE_MONEYSOURCE",entity:e})},getMoneySourceTypes:function(t){return(0,t.dispatch)("get",{url:"/bookkeeping/moneysourcetypes/",mutation:"SET_MONEYSOURCETYPES"})},createMoneySourceType:function(t,e){(0,t.dispatch)("create",{url:"/bookkeeping/moneysourcetypes/",mutation:"CREATE_MONEYSOURCETYPE",entity:e,afterDispatch:"getMoneySourceTypes"})},updateMoneySourceType:function(t,e){(0,t.dispatch)("update",{url:"/bookkeeping/moneysourcetypes/"+e.id,mutation:"UPDATE_MONEYSOURCETYPE",entity:e})},deleteMoneySourceType:function(t,e){return(0,t.dispatch)("delete",{url:"/bookkeeping/moneysourcetypes/"+e.id,mutation:"DELETE_MONEYSOURCETYPE",entity:e})},getBalances:function(t){return(0,t.dispatch)("get",{url:"/bookkeeping/balances/",mutation:"SET_BALANCES"})}},mutations:(X={},nt()(X,"CREATE_TRANSACTION",function(t,e){e.transaction}),nt()(X,"UPDATE_TRANSACTION",function(t,e){var n=e.transaction,o=t.transactions.find(function(t){return t.id===n.id});k()(o,n)}),nt()(X,"DELETE_TRANSACTION",function(t,e){var n=e.transaction,o=t.transactions.findIndex(function(t){return t.id===n.id});t.transactions.splice(o,1)}),nt()(X,"SET_TRANSACTIONS",function(t,e){var n=e.transactions;t.transactions=n}),nt()(X,"SET_CATEGORIES",function(t,e){var n=e.value;t.categories=n}),nt()(X,"CREATE_CATEGORY",function(t,e){e.value}),nt()(X,"UPDATE_CATEGORY",function(t,e){var n=e.value;console.log(n);var o=t.categories.find(function(t){return t.id===n.id});k()(o,n)}),nt()(X,"DELETE_CATEGORY",function(t,e){var n=e.value,o=t.categories.findIndex(function(t){return t.id===n.id});t.categories.splice(o,1)}),nt()(X,"SET_CATEGORIES",function(t,e){var n=e.value;t.categories=n}),nt()(X,"SET_CURRENT_PERIOD",function(t,e){var n=e.period;t.currentPeriod=n}),nt()(X,"SET_MONEYSOURCES",function(t,e){var n=e.value;t.moneySources=n}),nt()(X,"CREATE_MONEYSOURCE",function(t,e){e.value}),nt()(X,"UPDATE_MONEYSOURCE",function(t,e){var n=e.value,o=t.moneySources.find(function(t){return t.id===n.id});k()(o,n)}),nt()(X,"DELETE_MONEYSOURCE",function(t,e){var n=e.value,o=t.moneySources.findIndex(function(t){return t.id===n.id});t.moneySources.splice(o,1)}),nt()(X,"SET_MONEYSOURCETYPES",function(t,e){var n=e.value;t.moneySourceTypes=n}),nt()(X,"CREATE_MONEYSOURCETYPE",function(t,e){e.value}),nt()(X,"UPDATE_MONEYSOURCETYPE",function(t,e){var n=e.value,o=t.moneySourceTypes.find(function(t){return t.id===n.id});k()(o,n)}),nt()(X,"DELETE_MONEYSOURCETYPE",function(t,e){var n=e.value,o=t.moneySourceTypes.findIndex(function(t){return t.id===n.id});t.moneySourceTypes.splice(o,1)}),nt()(X,"SET_BALANCES",function(t,e){var n=e.value;n.forEach(function(t){t.values.sort(function(t,e){return"$"===t.currency?1:"грн"===e.currency?-1:void 0})}),t.balances=n}),X)},mt={state:{session:{logged:!!localStorage.getItem("USER_TOKEN"),token:localStorage.getItem("USER_TOKEN"),user:{name:""}}},getters:{logged:function(t){return t.session.logged},token:function(t){return t.session.token},userName:function(t){return t.session.user.name}},actions:{login:function(t,e){t.state;var n=t.commit,o=t.dispatch,i={};return k()(i,e),new w.a(function(t,e){st.post("/auth/token",{request:i}).then(function(e){n("LOGIN_SUCCESS",{token:e.data.access_token}),o("whoIAm"),t(!0)}).catch(function(t){return e(t)})})},logout:function(t){t.state;(0,t.commit)("LOGOUT")},whoIAm:function(t){var e=t.state,n=t.commit,o=t.getters;return new w.a(function(t,i){o.logged?st.post("/auth/userinfo",{token:e.session.token}).then(function(e){t(),n("WHO_I_AM",{name:e.data})},function(t){i(t),401===t.response.status&&(console.log(t.response),n("LOGOUT"))}):t()})}},mutations:(Z={},nt()(Z,"LOGIN",function(t){t.pending=!0}),nt()(Z,"LOGIN_SUCCESS",function(t,e){var n=e.token;t.session.logged=!0,t.session.token=n,localStorage.setItem("USER_TOKEN",n)}),nt()(Z,"LOGOUT",function(t){localStorage.removeItem("USER_TOKEN"),t.session.token=null,t.session.logged=!1}),nt()(Z,"WHO_I_AM",function(t,e){var n=e.name;t.session.user.name=n}),Z)};o.default.use(p.a);var gt=new p.a.Store({modules:{bookKeeping:ft,auth:mt}}),yt=n("HSQo"),ht=n.n(yt),bt=n("Gu7T"),vt=n.n(bt),Et=n("Icdr"),St=n.n(Et),Tt=n("Rnxn"),_t=n.n(Tt),kt=n("472O"),Ot=["legendselectchanged","legendselected","legendunselected","legendunscroll","datazoom","datarangeselected","timelinechanged","timelineplaychanged","restore","dataviewchanged","magictypechanged","geoselectchanged","geoselected","geounselected","pieselectchanged","pieselected","pieunselected","mapselectchanged","mapselected","mapunselected","axisareaselected","focusnodeadjacency","unfocusnodeadjacency","brush","brushselected","rendered","finished","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"],wt={props:{options:Object,theme:[String,Object],initOptions:Object,group:String,autoResize:Boolean,watchShallow:Boolean,manualUpdate:Boolean},data:function(){return{lastArea:0}},watch:{group:function(t){this.chart.group=t}},methods:{mergeOptions:function(t,e,n){this.manualUpdate&&(this.manualOptions=t),this.chart?this.delegateMethod("setOption",t,e,n):this.init()},appendData:function(t){this.delegateMethod("appendData",t)},resize:function(t){this.delegateMethod("resize",t)},dispatchAction:function(t){this.delegateMethod("dispatchAction",t)},convertToPixel:function(t,e){return this.delegateMethod("convertToPixel",t,e)},convertFromPixel:function(t,e){return this.delegateMethod("convertFromPixel",t,e)},containPixel:function(t,e){return this.delegateMethod("containPixel",t,e)},showLoading:function(t,e){this.delegateMethod("showLoading",t,e)},hideLoading:function(){this.delegateMethod("hideLoading")},getDataURL:function(t){return this.delegateMethod("getDataURL",t)},getConnectedDataURL:function(t){return this.delegateMethod("getConnectedDataURL",t)},clear:function(){this.delegateMethod("clear")},dispose:function(){this.delegateMethod("dispose")},delegateMethod:function(t){var e;this.chart||this.init();for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return(e=this.chart)[t].apply(e,vt()(o))},delegateGet:function(t,e){return this.chart||this.init(),this.chart[e]()},getArea:function(){return this.$el.offsetWidth*this.$el.offsetHeight},init:function(){var t=this;if(!this.chart){var e=St.a.init(this.$el,this.theme,this.initOptions);this.group&&(e.group=this.group),e.setOption(this.manualOptions||this.options||{},!0),Ot.forEach(function(n){e.on(n,function(e){t.$emit(n,e)})}),this.autoResize&&(this.lastArea=this.getArea(),this.__resizeHandler=_t()(function(){0===t.lastArea?(t.mergeOptions({},!0),t.resize(),t.mergeOptions(t.options||t.manualOptions||{},!0)):t.resize(),t.lastArea=t.getArea()},100,{leading:!0}),Object(kt.a)(this.$el,this.__resizeHandler)),ht()(this,{width:{configurable:!0,get:function(){return t.delegateGet("width","getWidth")}},height:{configurable:!0,get:function(){return t.delegateGet("height","getHeight")}},isDisposed:{configurable:!0,get:function(){return!!t.delegateGet("isDisposed","isDisposed")}},computedOptions:{configurable:!0,get:function(){return t.delegateGet("computedOptions","getOption")}}}),this.chart=e}},destroy:function(){this.autoResize&&Object(kt.b)(this.$el,this.__resizeHandler),this.dispose(),this.chart=null},refresh:function(){this.chart&&(this.destroy(),this.init())}},created:function(){var t=this;this.manualUpdate||this.$watch("options",function(e,n){!t.chart&&e?t.init():t.chart.setOption(e,e!==n)},{deep:!this.watchShallow});["theme","initOptions","autoResize","manualUpdate","watchShallow"].forEach(function(e){t.$watch(e,function(){t.refresh()},{deep:!0})})},mounted:function(){this.options&&this.init()},activated:function(){this.autoResize&&this.chart&&this.chart.resize()},beforeDestroy:function(){this.chart&&this.destroy()},connect:function(t){"string"!=typeof t&&(t=t.map(function(t){return t.chart})),St.a.connect(t)},disconnect:function(t){St.a.disConnect(t)},registerMap:function(t,e,n){St.a.registerMap(t,e,n)},registerTheme:function(t,e){St.a.registerTheme(t,e)},graphic:St.a.graphic},Mt={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"echarts"})},staticRenderFns:[]};var xt=n("VU/8")(wt,Mt,!1,function(t){n("ECZO")},null,null).exports;n("GbHy"),n("Vb+l"),n("Oq2I");o.default.component("chart",xt),u.a.use(s.a),o.default.config.productionTip=!1,o.default.use(r.a),new o.default({el:"#app",router:tt,components:{App:S},template:"<App/>",store:gt})},XbFk:function(t,e){},bNax:function(t,e){},"fx/J":function(t,e){},lRnY:function(t,e){},pT0i:function(t,e){},zSlc:function(t,e){},zruw:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.8cb015ab6e6678b7224a.js.map